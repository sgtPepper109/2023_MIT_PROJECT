<div id="predictionComponentBody">
    <p class="fixed-top">
        <mat-toolbar>
            <button mat-icon-button class="example-icon" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample"
                aria-controls="offcanvasExample" aria-label="Example icon-button with menu icon">
                <mat-icon>menu</mat-icon>
            </button>
            <span>Traffic Intensity Prediction and Recommendation</span>
            <span class="example-spacer"></span>
        </mat-toolbar>
    </p>

    <br /><br /><br /><br />

    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
        <div class="offcanvas-header">
            <h1 style="margin-left: 125px" class="offcanvas-title" id="offcanvasExampleLabel">Menu</h1>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <mat-divider></mat-divider>
        <div class="offcanvas-body">
            <ul class="list-group list-group-flush">
                <li class="offcanvasList list-group-item" (click)="navigateToTraining()">
                    <span style="float:left">Training</span>
                    <mat-icon style="float:right">keyboard_arrow_right</mat-icon>
                </li>
                <li class="offcanvasList list-group-item" data-bs-dismiss="offcanvas">
                    <span style="float:left">Predictions</span>
                    <mat-icon style="float:right">keyboard_arrow_right</mat-icon>
                </li>
                <li class="offcanvasList list-group-item" (click)="navigateToAdminInputs()">
                    <span style="float:left">Provide Junction Properties</span>
                    <mat-icon style="float:right">keyboard_arrow_right</mat-icon>
                </li>
            </ul>
        </div>
    </div>


    <section>
        <div *ngIf="toggleSuccessToast" class="toast show position-fixed bottom-0 end-0 p-3 box-overlay" role="alert"
            aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <span class="me-3">
                    <mat-icon style="color:green">check_circle</mat-icon>
                </span>
                <strong class="me-auto">System</strong>
                <small>1 second ago</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" style="color: green">
                {{ errorString }}
            </div>
        </div>
        <div *ngIf="toggleWarningToast" class="toast show position-fixed bottom-0 end-0 p-3 box-overlay" role="alert"
            aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <span class="me-3">
                    <mat-icon color="warn">report</mat-icon>
                </span>
                <strong class="me-auto">System</strong>
                <small>1 second ago</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" style="color: red">
                {{ errorString }}
            </div>
        </div>
        <mat-stepper orientation="horizontal" [linear]="isLinear" #stepper>
            <mat-step>
                <ng-template matStepLabel>See Predictions</ng-template>
                <mat-progress-bar *ngIf="!predictionsReady" mode="indeterminate"></mat-progress-bar>
                <div *ngIf="predictionsReady">
                    <mat-card *ngIf="!toggleFuturePredictionsTable">
                        <nav id="navbar-example3" class="navbar bg-body-tertiary px-3 mb-3"
                            aria-labelledby="navHeading">
                            <ul class="nav nav-pills">
                                <div class="container">
                                    <div class="row">
                                        <div style="width: 260px" class="col">
                                            <h4>Result for Junction</h4>
                                        </div>
                                        <div class="col">
                                            <select style="width: 200px" class="form-select"
                                                (change)="predict()" [(ngModel)]="junctionChoice"
                                                aria-label="Default select example">
                                                <option *ngFor="let junction of junctions" [value]="junction">{{
                                                    junction }}</option>
                                            </select>
                                        </div>
                                        <div class="col-5">
                                            <h4>for duration of <strong>{{ duration }} {{ time }}</strong></h4>
                                        </div>
                                    </div>
                                </div>
                            </ul>
                            <select style="width: 150px" class="form-select" [(ngModel)]="showBy"
                                (change)="predict()" aria-label="Default select example">
                                <option selected>Weeks</option>
                                <option value="Table">Months</option>
                            </select>
                            <select style="width: 150px" class="form-select" [(ngModel)]="predictionsOption"
                                (change)="changePredictionsOption()" aria-label="Default select example">
                                <option selected>Line Plot</option>
                                <option value="Table">Table</option>
                            </select>
                        </nav>
                        <mat-card-content *ngIf="resultTableReady">

                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        <div>
                                            <table class="table table-bordered border table-striped" aria-describedby="table2-desc">
                                                <thead>
                                                    <tr>
                                                        <th scope="col">DateTime</th>
                                                        <th scope="col">Vehicles</th>
                                                        <th scope="col">Year</th>
                                                        <th scope="col">Month</th>
                                                        <th scope="col">Day</th>
                                                        <th scope="col">Hour</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let record of dataSourceResult">
                                                        <th scope="row">{{ record.DateTime }}</th>
                                                        <td>{{ record.Vehicles }}</td>
                                                        <td>{{ record.Year }}</td>
                                                        <td>{{ record.Month }}</td>
                                                        <td>{{ record.Day }}</td>
                                                        <td>{{ record.Hour }}</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="col">
                                        <div>
                                            <div class="alert alert-{{alert}}">
                                                <section>
                                                    <div class="collapse show" id="collapseStarsTable">
                                                        <div>
                                                            <div>
                                                                <button mat-fab extended color="warn">
                                                                    <mat-icon *ngFor="let icon of starsTableDesc[importanceLevel]">{{ icon }}</mat-icon>
                                                                </button>
                                                                <button mat-icon-button type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                                                                    <mat-icon>info</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <h1>{{starsTableMeaning[importanceLevel]}}</h1>
                                                        </div>
                                                        <div class="collapse" id="collapseExample" style="padding-top: 10px">
                                                            <table class="table table-bordered border-danger">
                                                                <thead>
                                                                    <tr>
                                                                        <th scope="col">Stars</th>
                                                                        <th scope="col">Meaning</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[0]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[0]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[1]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[1]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[2]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[2]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[3]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[3]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[4]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[4]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[5]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[5]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <th scope="row">
                                                                            <mat-icon *ngFor="let icon of starsTableDesc[6]">{{ icon }}</mat-icon>
                                                                        </th>
                                                                        <td>
                                                                            <p>{{starsTableMeaning[6]}}</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <p><mat-checkbox [(ngModel)]="checkRecommendation" color="primary" [disabled]="disableCheck">Recommend
                                                            treatment for ({{ this.junctionChoice }}, {{ this.currentDistrict }}
                                                            district)? </mat-checkbox></p>
                                                    </div>
                                                    <div>
                                                        <span>
                                                            <button mat-raised-button [disabled]="disableCheck || !checkRecommendation"
                                                                (click)="enqueueRecommendation()"
                                                                ><mat-icon>queue</mat-icon>Enqueue treatment
                                                                recommendation</button>
                                                        </span>
                                                        <span style="padding-left: 10px">
                                                            <button mat-raised-button [disabled]="alert=='danger'" (click)="dequeueRecommendation()"><mat-icon>remove_circle_outline</mat-icon>Dequeue Recommendation</button>
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <div style="padding-top: 10px">
                                                            <span>
                                                                <button mat-raised-button
                                                                    data-bs-toggle="modal" 
                                                                    data-bs-target="#exampleModal"
                                                                ><mat-icon>delete_sweep</mat-icon>Clear All Recommendations</button>
                                                            </span>
                                                            <span style="padding-left: 10px">
                                                                <button mat-raised-button color="primary"
                                                                    (click)="downloadPredictions()"><mat-icon>save</mat-icon>Download
                                                                    Predictions as csv file</button>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </section>
                                                <div class="modal fade" id="exampleModal" tabindex="-1"
                                                    aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h1 class="modal-title fs-5" id="exampleModalLabel">
                                                                    Clear All Recommendations
                                                                </h1>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                                    aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body">
                                                                Are you sure you want to clear all recommendations? 
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" mat-raised-button color="warn"
                                                                    data-bs-dismiss="modal">Close</button>
                                                                <button (click)="clearAllRecommendations()" type="button" mat-raised-button color="primary"
                                                                data-bs-dismiss="modal"
                                                                >Save
                                                                    changes</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!--
                                    ** Paginator for Prediction table **
                                -->
                            <div id="paginator2" class="justify-content-end btn-group" role="group"
                                aria-label="Button group with nested dropdown">
                                <button type="button" [ngClass]="classForPreviousButtonResult"
                                    (click)="previousResult()" class="btn btn-outline-secondary">{{'\u21E6'}}</button>
                                <button type="button" id="paginator2indicator" class="btn btn-outline-secondary"
                                    disabled>{{indexResult}} - {{indexResult + 10}} of
                                    {{numberOfRecordsResult}}</button>
                                <button type="button" [ngClass]="classForNextButtonResult" (click)="nextResult()"
                                    class="btn btn-outline-secondary">{{'\u21E8'}}</button>
                            </div>
                        </mat-card-content>
                    </mat-card>
                </div>

                <!--
                        ** Vehicles vs DateTime chart for provided junction number and number of days **
                    -->
                <mat-card [hidden]="!toggleFuturePredictionsTable">
                    <nav *ngIf="predictionsReady" id="navbar-example3" class="navbar bg-body-tertiary px-3 mb-3"
                        aria-labelledby="navHeading">
                        <ul class="nav nav-pills">
                            <div class="container">
                                <div class="row">
                                    <div style="width: 260px" class="col">
                                        <h4>Result for Junction</h4>
                                    </div>
                                    <div class="col">
                                        <select style="width: 200px" class="form-select" (change)="predict()"
                                            [(ngModel)]="junctionChoice" aria-label="Default select example">
                                            <option *ngFor="let junction of junctions" [value]="junction">{{ junction }}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-5">
                                        <h4>for duration of <strong>{{ duration }} {{ time }}</strong></h4>
                                    </div>
                                </div>
                            </div>
                        </ul>
                        <select style="float:right; width: 150px" class="form-select" [(ngModel)]="showBy"
                            (change)="predict()" aria-label="Default select example">
                            <option selected>Weeks</option>
                            <option value="Table">Months</option>
                        </select>
                        <select style="width: 150px" class="form-select" [(ngModel)]="predictionsOption"
                            (change)="changePredictionsOption()" aria-label="Default select example">
                            <option selected>Line Plot</option>
                            <option value="Table">Table</option>
                        </select>
                    </nav>
                    <mat-card-content [hidden]="!predictionsReady">
                        <div>
                            <div class="row">
                                <div class="col">
                                    <div [hidden]="futurePredictionsChartHidden">
                                        <div>
                                            <canvas style="height: 200px" id="myChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div>
                                        <div class="alert alert-{{alert}}">
                                            <section>
                                                <div class="collapse show" id="collapseStarsTable">
                                                    <div>
                                                        <div>
                                                            <button mat-fab extended color="warn">
                                                                <mat-icon *ngFor="let icon of starsTableDesc[importanceLevel]">{{ icon }}</mat-icon>
                                                            </button>
                                                            <button mat-icon-button type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                                                                <mat-icon>info</mat-icon>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div>
                                                        <h1>{{starsTableMeaning[importanceLevel]}}</h1>
                                                    </div>
                                                    <div class="collapse" id="collapseExample" style="padding-top: 10px">
                                                        <table class="table table-bordered border-danger">
                                                            <thead>
                                                                <tr>
                                                                    <th scope="col">Stars</th>
                                                                    <th scope="col">Meaning</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[0]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[0]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[1]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[1]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[2]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[2]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[3]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[3]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[4]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[4]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[5]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[5]}}</p>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <th scope="row">
                                                                        <mat-icon *ngFor="let icon of starsTableDesc[6]">{{ icon }}</mat-icon>
                                                                    </th>
                                                                    <td>
                                                                        <p>{{starsTableMeaning[6]}}</p>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                <div>
                                                    <p><mat-checkbox [(ngModel)]="checkRecommendation" color="primary" [disabled]="disableCheck">Recommend
                                                        treatment for ({{ this.junctionChoice }}, {{ this.currentDistrict }}
                                                        district)? </mat-checkbox></p>
                                                </div>
                                                <div>
                                                    <span>
                                                        <button mat-raised-button [disabled]="disableCheck || !checkRecommendation"
                                                            (click)="enqueueRecommendation()"
                                                            ><mat-icon>queue</mat-icon>Enqueue treatment
                                                            recommendation</button>
                                                    </span>
                                                    <span style="padding-left: 10px">
                                                        <button mat-raised-button [disabled]="alert=='danger'" (click)="dequeueRecommendation()"><mat-icon>remove_circle_outline</mat-icon>Dequeue Recommendation</button>
                                                    </span>
                                                </div>
                                                <div>
                                                    <div style="padding-top: 10px">
                                                        <span>
                                                            <button mat-raised-button
                                                                data-bs-toggle="modal" 
                                                                data-bs-target="#exampleModal"
                                                            ><mat-icon>delete_sweep</mat-icon>Clear All Recommendations</button>
                                                        </span>
                                                        <span style="padding-left: 10px">
                                                            <button mat-raised-button color="primary"
                                                                (click)="downloadPredictions()"><mat-icon>save</mat-icon>Download
                                                                Predictions as csv file</button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </section>
                                            <div class="modal fade" id="exampleModal" tabindex="-1"
                                                aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h1 class="modal-title fs-5" id="exampleModalLabel">
                                                                Clear All Recommendations
                                                            </h1>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                                aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body">
                                                            Are you sure you want to clear all recommendations? 
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button type="button" mat-raised-button color="warn"
                                                                data-bs-dismiss="modal">Close</button>
                                                            <button (click)="clearAllRecommendations()" type="button" mat-raised-button color="primary"
                                                            data-bs-dismiss="modal"
                                                            >Save
                                                                changes</button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </mat-card-content>
                </mat-card>
            </mat-step>


            <mat-step>
                <ng-template matStepLabel>Districts with treatments</ng-template>
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">District</th>
                            <th scope="col">Number of treatment recommendations</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let element of allDistrictsRecommended">
                            <th scope="row">{{ element.districtName }}</th>
                            <td>{{ element.numberOfTreatmentRecommendations }}</td>
                        </tr>
                    </tbody>
                </table>

            </mat-step>


            <mat-step *ngIf="autoTrained">

                <ng-template matStepLabel>Accuracies of Differenct Junctions</ng-template>
                <div style="padding-top: 10px" class="container">
                    <div class="row">
                        <div class="col">
                            <nav id="navbar-example3" class="navbar bg-body-tertiary px-3 mb-3"
                                aria-labelledby="navHeading">
                                <ul class="nav nav-pills">
                                    <div class="container">
                                        <div class="row">
                                            <div style="width: 240px" class="col">
                                                <h4>Accuracies of all junctions</h4>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                                <select style="width: 150px" class="form-select" [(ngModel)]="accuraciesOption"
                                    (change)="changeAccuraciesOption()" aria-label="Default select example">
                                    <option selected>Line Plot</option>
                                    <option value="Table">Table</option>
                                </select>
                            </nav>
                            <div>
                                <div [hidden]="!toggleAccuracyTable">
                                    <div>
                                        <canvas width="600" height="600" id="accuracyComparison"></canvas>
                                    </div>
                                </div>
                                <div [hidden]="toggleAccuracyTable">
                                    <div>
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Junction</th>
                                                    <th scope="col">Accuracy</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let record of accuracyComparisonTableData">
                                                    <th scope="row">{{ record.junctionOrAlgorithm }}</th>
                                                    <td>{{ record.accuracy }}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <nav id="navbar-example3" class="navbar bg-body-tertiary px-3 mb-3"
                                aria-labelledby="navHeading">
                                <ul class="nav nav-pills">
                                    <div class="container">
                                        <div class="row">
                                            <div style="width: 240px" class="col">
                                                <h4>Accuracy for junction</h4>
                                            </div>
                                            <div class="col">
                                                <select style="width: 200px" class="form-select"
                                                    (change)="renderJunctionAccuracyPie()" [(ngModel)]="currentPie"
                                                    aria-label="Default select example">
                                                    <option *ngFor="let junction of junctions" [value]="junction">{{
                                                        junction }}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </ul>
                            </nav>
                            <div>
                                <div>
                                    <div>
                                        <canvas width="600" height="600" id="accuracyPie"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </mat-step>
        </mat-stepper>
    </section>


</div>