<div id="text-center" class="container p-5 my-5 bg-primary shadow-lg p-3 mb-5 bg-white rounded">
    <section>
        <h1>Traffic Predictor</h1>
        <hr id="hrTag1" />
        <br />


        <!-- 
            ** Table for displaying the csv data **
        -->
        <h4 id="table1-desc"><strong>How your data looks: </strong></h4>
        <mat-card>
            <mat-card-content>
                
                <table class="table table-bordered border table-striped" aria-describedby="tabe1-desc">
                    <thead>
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">Junction</th>
                            <th scope="col">DateTime</th>
                            <th scope="col">Vehicles</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let record of dataSource">
                            <th scope="row">{{ record.ID }}</th>
                            <td>{{ record.Junction }}</td>
                            <td>{{ record.DateTime }}</td>
                            <td>{{ record.Vehicles }}</td>
                        </tr>
                    </tbody>
                </table>

                <!-- 
                    ** Paginator for table **
                -->
                <div id="paginator1" class="justify-content-end btn-group" role="group" aria-label="Button group with nested dropdown">
                    <button type="button" [ngClass]="classForPreviousButton" (click)="previous()" class="btn btn-outline-secondary">{{'\u21E6'}}</button>
                    <button type="button" id="paginator1indicator" class="btn btn-outline-secondary" disabled>{{index}} - {{index +5}} of {{numberOfRecords}}</button>
                    <button type="button" [ngClass]="classForNextButton" (click)="next()" class="btn btn-outline-secondary">{{'\u21E8'}}</button>
                </div>
            </mat-card-content>
        </mat-card>
        <br />

        
        <!-- 
            ** Vehicles vs DateTime plots for all junctions **
        -->
        <br />
        <mat-card>
            <mat-card-content>
                <h4><strong>Number of vehicles over time</strong></h4>
                <nav aria-label="Page navigation example">
                    <ul class="pagination" id="toggleJunction">
                        <li class="page-item" (click)="show1()"><a class="page-link">Junction 1</a></li>
                        <li class="page-item" (click)="show2()"><a class="page-link">Junction 2</a></li>
                        <li class="page-item" (click)="show3()"><a class="page-link">Junction 3</a></li>
                        <li class="page-item" (click)="show4()"><a class="page-link">Junction 4</a></li>
                    </ul>
                </nav>
                <div *ngIf="plotReady">  <!-- Canvas for showing plot -->
                    <div>
                        <canvas id="plot"></canvas>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>


        <!--
            ** Prediction Part **
        -->
        <br />
        <br />
        <h2>PREDICTION</h2>

        <!--
            ** Input junction number and number of days
        -->
        <div class="row">
            <div class="col input-group mb-3" id="inputJunctionTime">
                <span class="input-group-text" id="basic-addon1" style="height:40px">Junction</span>
                <select id="dropdown" class="col form-select" aria-label="Default select example" style="height:40px"
                    [(ngModel)]="inputJunction" (change)="disablePredictionImage()">
                    <option selected value="Choose Junction">Choose Junction</option>
                    <option value=1>1</option>
                    <option value=2>2</option>
                    <option value=3>3</option>
                    <option value=4>4</option>
                </select>
            </div>
            <div class="col input-group mb-3">
                <span><input type="number" class="form-control" aria-label="Text input with dropdown button" [(ngModel)]="inputTime" style="height: 40px;"></span>
                <select class="form-select" id="autoSizingSelect" [(ngModel)]="time">
                    <option selected>Days</option>
                    <option value="Months">Months</option>
                    <option value="Years">Years</option>
                </select>
            </div>
            

            <div class="col input-group mb-3">
                <span class="input-group-text" style="height:40px">Algorithm</span>
                <select class="col form-select" aria-label="Default select example" [(ngModel)]="inputAlgorithm">
                    <option selected>Random Forest Regression</option>
                    <option value="Gradient Boosting Regression">Gradient Boosting Regression</option>
                    <option value="Linear Regression">Linear Regression</option>
                    <option value="Logistic Regression">Logistic Regression</option>
                    <option value="Ridge Regression">Ridge Regression</option>
                    <option value="Lasso Regression">Lasso Regression</option>
                    <option value="Bayesian Ridge Regression">Bayesian Ridge Regression</option>
                </select>
            </div>


            <div class="text-center">
                <button id="predictionStartButton" type="button" class="btn btn-primary"
                    (click)="start()">Start</button>
            </div>
        </div>
          

        <!--
            ** spinner **
        -->
        <div *ngIf="startedTraining" class="d-flex align-items-center">
            Loading...
            <div id="spinner" class="spinner-grow ml-auto" role="status" aria-hidden="true"></div>
        </div>


        <!--
            ** Table for showing predictions for provided junction and number of days
        -->
        <mat-card *ngIf="resultTableReady">
            <mat-card-content>
                <h4 id="table2-desc"><strong>Result for Junction {{inputJunction}} for duration of {{inputTime}} {{time}}</strong></h4>

                <table class="table table-bordered border table-striped" aria-describedby="table2-desc">
                    <thead>
                        <tr>
                            <th scope="col">DateTime</th>
                            <th scope="col">Vehicles</th>
                            <th scope="col">Year</th>
                            <th scope="col">Month</th>
                            <th scope="col">Day</th>
                            <th scope="col">Hour</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let record of dataSourceResult">
                            <th scope="row">{{ record.DateTime }}</th>
                            <td>{{ record.Vehicles }}</td>
                            <td>{{ record.Year }}</td>
                            <td>{{ record.Month }}</td>
                            <td>{{ record.Day }}</td>
                            <td>{{ record.Hour }}</td>
                        </tr>
                    </tbody>
                </table>


                <!--
                    ** Paginator for Prediction table **
                -->
                <div id="paginator2" class="justify-content-end btn-group" role="group" aria-label="Button group with nested dropdown">
                    <button type="button" [ngClass]="classForPreviousButtonResult" (click)="previousResult()" class="btn btn-outline-secondary">{{'\u21E6'}}</button>
                    <button type="button" id="paginator2indicator" class="btn btn-outline-secondary" disabled>{{indexResult}} - {{indexResult + 10}} of {{numberOfRecordsResult}}</button>
                    <button type="button" [ngClass]="classForNextButtonResult" (click)="nextResult()" class="btn btn-outline-secondary">{{'\u21E8'}}</button>
                </div>
            </mat-card-content>
        </mat-card>

        <!--
            ** Vehicles vs DateTime chart for provided junction number and number of days **
        -->
        <mat-card>
            <mat-card-content>
                <div>
                    <div>
                        <canvas id="myChart"></canvas>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>


        <!--
            ** Actual and Predicted values comparison on test data **
        -->
        <mat-card>
            <br />
            <hr />
            <mat-card-content *ngIf="predictedTableReady">
                
                <!--
                    ** Accuracy **
                -->
                <div *ngIf="gotAccuracy">
                    <h4><strong>Visualizing the testing data: </strong></h4>
                    <h4><strong>Accuracy Score of {{inputAlgorithm}} on {{testRatio * 100}} % of data: </strong></h4>
                    <h3>{{ accuracyScore * 100}}</h3>
                </div>

                <!--
                    ** Table for showing actual and predicted values comparison **
                -->
                <h4 id="table3-desc"><strong>Actual and predicted values:</strong></h4>
                <table class="table table-bordered border table-striped-columns" aria-describedby="table3-desc">
                    <thead>
                        <tr>
                            <th scope="col">Actual</th>
                            <th scope="col">Predicted</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let record of dataSourcePredicted">
                            <th scope="row">{{ record.actual}}</th>
                            <td>{{ record.predictedData}}</td>
                        </tr>
                    </tbody>
                </table>




                <!--
                    ** Paginator for table **
                -->
                <div id="paginator3" class="justify-content-end btn-group" role="group" aria-label="Button group with nested dropdown">
                    <button type="button" [ngClass]="classForPreviousButtonPredicted" (click)="previousPredicted()" class="btn btn-outline-secondary">{{'\u21E6'}}</button>
                    <button type="button" id="paginator3indicator" class="btn btn-outline-secondary" disabled>{{predictedTableIndex}} - {{predictedTableIndex + 5}} of {{numberOfRecordsPredicted}}</button>
                    <button type="button" [ngClass]="classForNextButtonPredicted" (click)="nextPredicted()" class="btn btn-outline-secondary">{{'\u21E8'}}</button>
                </div>
                
            </mat-card-content>
        </mat-card>


        <!--
            ** Chart For comparison of Actual and Predicted Values **
        -->
        <div>
            <div>
                <canvas id="predictedChart"></canvas>
            </div>
        </div>
        <br />

        <!--
            ** Paginator for Chart **
        -->
        <div id="paginator4" class="justify-content-end btn-group" role="group" aria-label="Button group with nested dropdown">
            <button type="button" [ngClass]="classForPreviousButtonPlot" (click)="previous10Plot()" class="btn btn-outline-secondary">{{'\u21E6'}}</button>
            <button type="button" id="paginator4indicator" class="btn btn-outline-secondary" disabled>{{predictedChartIndex}} - {{predictedChartIndex + 10}} of {{numberOfPlotDataEntries}}</button>
            <button type="button" [ngClass]="classForNextButtonPlot" (click)="next10Plot()" class="btn btn-outline-secondary">{{'\u21E8'}}</button>
        </div>

        <br />
        <br />
        <hr />
        <br />

        <!--
            ** Export To CSV option
        -->
        <div *ngIf="predictionImageReady" class="text-center">
            <button id="exportButton" type="button" class="btn btn-primary" (click)="exportToCsv()">Export To csv file</button>
        </div>

        <!--
            ** Error Alert
        -->
        <div id="errorAlert" *ngIf="toggleErrorString" class="alert alert-danger" role="alert">
            {{ errorstring }}
        </div>

    </section>
</div>